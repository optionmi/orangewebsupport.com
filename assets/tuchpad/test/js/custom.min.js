var base_url=$("base").attr("href");toastr.options={closeButton:false,debug:false,newestOnTop:false,progressBar:true,positionClass:"toast-top-right",preventDuplicates:false,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};$('.bs-component [data-toggle="popover"]').popover();$('.bs-component [data-toggle="tooltip"]').tooltip();var userTable=$(".userTables").DataTable({serverSide:false,ajax:base_url+"admin_master/users",columns:[{data:"sr_no"},{data:"name"},{data:"mobile"},{data:"email"},{data:"level"},{data:"last_login"},{data:"action"}]});$("#addUser").on("aftersubmit",function(b,a){$("#pleasewait").modal("hide");toastr[a.type](a.message);console.log(a);if(a.type==="success"){userTable.ajax.url(base_url+"admin_master/users").load();$(this).trigger("reset");$("#add-new-user").modal("hide")}});$("#update-user").on("aftersubmit",function(b,a){toastr[a.type](a.message);if(a.type==="success"){location.reload(true)}});$(".userTables").on("click",".delete_user",function(){var a=$(this).attr("user_id");console.log(a);swal({title:"Are you sure?",text:"You won't be able to revert this!",type:"warning",showCancelButton:true,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, Delete !"}).then(function(b){if(b.value){$.ajax({url:base_url+"admin_master/delete_user",type:"post",dataType:"json",data:{id:a},success:function(c){if(c.type==="success"){userTable.ajax.url(base_url+"admin_master/users").load()}else{if(c.type==="error"){toastr[c.type](c.message)}}},error:function(c){console.log("unable to send request..")}})}})});$("#updateUserPro").on("aftersubmit",function(b,a){$("#pleasewait").modal("hide");toastr[a.type](a.message);if(a.type==="success"){location.reload(true)}});$("#updateUserProfile").on("aftersubmit",function(b,a){$("#pleasewait").modal("hide");if(a.type==="success"){toastr[a.type](a.message);$.ajax({url:base_url+"superadmin/logout"})}});$(document).ready(function(){$(document).on("change","#logo_img_schooll",function(){var a=new FormData();a.append("logo_img",$("#logo_img_schooll").prop("files")[0]);$.ajax({url:base_url+"admin_master/editSchoolLogo",type:"post",data:a,contentType:false,cache:false,processData:false,dataType:"json",success:function(b){toastr[b.type](b.message)},error:function(b){console.log("unable to send request..")}})})});var permissionTable=$(".permissionTables").DataTable({serverSide:false,ajax:base_url+"admin_master/permissions",columns:[{data:"sr_no"},{data:"name"},{data:"action"}]});$("#addPermission").on("aftersubmit",function(b,a){$("#pleasewait").modal("hide");toastr[a.type](a.message);if(a.type==="success"){permissionTable.ajax.url(base_url+"admin_master/permissions").load();$(this).trigger("reset");$("#add-new-permission").modal("hide")}});$(".permissionTables").on("click",".edit-permission",function(){var a=$(this).attr("permission_id");$.ajax({url:base_url+"admin_master/retrieve/permission/id/"+a,type:"post",dataType:"json",data:{id:a},success:function(c){var b=c.data[0];$("#permission_id").val(b.id);$("#getname").val(b.name)},error:function(b){console.log("unable to send request..")}})});$("#update-permission").on("aftersubmit",function(b,a){console.log(a);toastr[a.type](a.message);if(a.type==="success"){$("#edit-permission").modal("hide");permissionTable.ajax.url(base_url+"admin_master/permissions").load()}});$(".permissionTables").on("click",".delete_permission",function(){var a=$(this).attr("permission_id");swal({title:"Are you sure?",text:"You won't be able to revert this!",type:"warning",showCancelButton:true,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, Delete !"}).then(function(b){if(b.value){$.ajax({url:base_url+"admin_master/delete_permission",type:"post",dataType:"json",data:{id:a},success:function(c){if(c.type==="success"){permissionTable.ajax.url(base_url+"admin_master/permissions").load()}else{if(c.type==="error"){toastr[c.type](c.message)}}},error:function(c){console.log("unable to send request..")}})}})});var clientTable=$(".clientTables").DataTable({serverSide:false,ajax:base_url+"admin_master/client",columns:[{data:"sr_no"},{data:"name"},{data:"person"},{data:"mobile"},{data:"email"},{data:"address"},{data:"action"}]});$("#addClient").on("aftersubmit",function(b,a){$("#pleasewait").modal("hide");toastr[a.type](a.message);if(a.type==="success"){clientTable.ajax.url(base_url+"admin_master/client").load();$(this).trigger("reset");$("#add-new-client").modal("hide")}});$(".clientTables").on("click",".edit-client",function(){var a=$(this).attr("client_id");$.ajax({url:base_url+"admin_master/retrieve/client/id/"+a,type:"post",dataType:"json",data:{id:a},success:function(c){var b=c.data[0];$("#client_id").val(b.id);$("#getcompany_name").val(b.name);$("#getcontact_person").val(b.person);$("#getcontact_mobile").val(b.mobile);$("#getcontact_email").val(b.email);$("#getcontact_address").val(b.address)},error:function(b){console.log("unable to send request..")}})});$("#update-client").on("aftersubmit",function(b,a){toastr[a.type](a.message);if(a.type==="success"){$("#edit-client").modal("hide");clientTable.ajax.url(base_url+"admin_master/client").load()}});$(".clientTables").on("click",".delete_client",function(){var a=$(this).attr("client_id");swal({title:"Are you sure?",text:"You won't be able to revert this!",type:"warning",showCancelButton:true,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, Delete !"}).then(function(b){if(b.value){$.ajax({url:base_url+"admin_master/delete_client",type:"post",dataType:"json",data:{id:a},success:function(c){if(c.type==="success"){toastr[c.type](c.message);clientTable.ajax.url(base_url+"admin_master/client").load()}else{if(c.type==="error"){toastr[c.type](c.message)}}},error:function(c){console.log("unable to send request..")}})}})});var employeeTable=$(".employeeTables").DataTable({serverSide:false,ajax:base_url+"admin_master/employee",columns:[{data:"sr_no"},{data:"name"},{data:"designation"},{data:"department"},{data:"mobile"},{data:"email"},{data:"action"}]});$("#addEmployee").on("aftersubmit",function(b,a){$("#pleasewait").modal("hide");toastr[a.type](a.message);if(a.type==="success"){employeeTable.ajax.url(base_url+"admin_master/employee").load();$(this).trigger("reset");$("#add-new-employee").modal("hide")}});$(".employeeTables").on("click",".edit-employee",function(){var a=$(this).attr("employee_id");$.ajax({url:base_url+"admin_master/retrieve/employee/id/"+a,type:"post",dataType:"json",data:{id:a},success:function(b){var c=b.data[0];$("#employee_id").val(c.id);$("#getemp_name").val(c.name);$("#getemp_designation").val(c.designation);$("#getemp_department").val(c.department);$("#getemp_mobile").val(c.mobile);$("#getemp_email").val(c.email)},error:function(b){console.log("unable to send request..")}})});$("#update-employee").on("aftersubmit",function(b,a){toastr[a.type](a.message);if(a.type==="success"){$("#edit-employee").modal("hide");employeeTable.ajax.url(base_url+"admin_master/employee").load()}});$(".employeeTables").on("click",".delete_employee",function(){var a=$(this).attr("employee_id");swal({title:"Are you sure?",text:"You won't be able to revert this!",type:"warning",showCancelButton:true,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, Delete !"}).then(function(b){if(b.value){$.ajax({url:base_url+"admin_master/delete_employee",type:"post",dataType:"json",data:{id:a},success:function(c){if(c.type==="success"){toastr[c.type](c.message);employeeTable.ajax.url(base_url+"admin_master/employee").load()}else{if(c.type==="error"){toastr[c.type](c.message)}}},error:function(c){console.log("unable to send request..")}})}})});var projectTable=$(".projectTables").DataTable({serverSide:false,ajax:base_url+"admin_master/project",columns:[{data:"sr_no"},{data:"name"},{data:"client_id"},{data:"department"},{data:"start_date"},{data:"due_date"},{data:"progress"},{data:"status"},{data:"payment_status"},{data:"action"}]});$("#addProject").on("aftersubmit",function(b,a){$("#pleasewait").modal("hide");toastr[a.type](a.message);if(a.type==="success"){projectTable.ajax.url(base_url+"admin_master/project").load();$(this).trigger("reset");$("#add-new-project").modal("hide")}});$(".projectTables").on("click",".edit-project",function(){var a=$(this).attr("project_id");$.ajax({url:base_url+"admin_master/retrieve/project/id/"+a,type:"post",dataType:"json",data:{id:a},success:function(b){var c=b.data[0];$("#project_id").val(c.id);$("#getproject_name").val(c.name);$("#getproject_department").val(c.department);$("#getproject_client").val(c.client_id);$("#getproject_type").val(c.type);$("#getproject_cost").val(c.cost);$("#getproject_start").val(c.start_date);$("#getproject_due").val(c.due_date);$("#getproject_status").val(c.status);$("#getproject_payment").val(c.payment_status);$("#getproject_desc").val(c.desc)},error:function(b){console.log("unable to send request..")}})});$("#update-project").on("aftersubmit",function(b,a){toastr[a.type](a.message);if(a.type==="success"){$("#edit-project").modal("hide");projectTable.ajax.url(base_url+"admin_master/project").load()}});$(".projectTables").on("click",".delete_project",function(){var a=$(this).attr("project_id");swal({title:"Are you sure?",text:"You won't be able to revert this!",type:"warning",showCancelButton:true,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, Delete !"}).then(function(b){if(b.value){$.ajax({url:base_url+"admin_master/delete_project",type:"post",dataType:"json",data:{id:a},success:function(c){if(c.type==="success"){toastr[c.type](c.message);projectTable.ajax.url(base_url+"admin_master/project").load()}else{if(c.type==="error"){toastr[c.type](c.message)}}},error:function(c){console.log("unable to send request..")}})}})});$(".append-new").on("click",function(){var b='<div class="row mb-3 m-0 p-2 bg-gray item-row"><div class="col-lg-12 p-2 sub-task"><h5>Sub Task</h5></div><div class="col-lg-6 p-2"><div class="form-group"><label for="task_subtask">Sub Task Name</label><input type="text" class="form-control" id="task_subtask" name="task_subtask[]"></div></div><div class="col-lg-6 p-2"><div class="form-group"><label for="task_start_date">Sub Task Start Date</label><input type="date" class="form-control" id="task_start_date" name="task_start_date[]"></div></div><div class="col-lg-6 p-2"><div class="form-group"><label for="task_due_date">Sub Task Due Date</label><input type="date" class="form-control" id="task_due_date" name="task_due_date[]"></div></div><div class="col-lg-6 p-2"><div class="form-group"><label for="task_complete_date">Sub Task Complete Date</label><input type="date" class="form-control" id="task_complete_date" name="task_complete_date[]"></div></div><div class="col-lg-6 p-2"><div class="form-group"><label for="task_approve_date">Sub Task Approve Date</label><input type="date" class="form-control" id="task_approve_date" name="task_approve_date[]"></div></div></div>';var a=$(this).index('[name="'+$(this).attr("name")+'"]');$(".tem-s").append(b);$($('[name="'+$(this).attr("name")+'"]')[a+1]).click();return false});var taskTable=$(".taskTables").DataTable({serverSide:false,ajax:base_url+"admin_master/task",columns:[{data:"sr_no"},{data:"name"},{data:"project_id"},{data:"status"},{data:"action"}]});$("#addTask").on("aftersubmit",function(b,a){$("#pleasewait").modal("hide");toastr[a.type](a.message);if(a.type==="success"){taskTable.ajax.url(base_url+"admin_master/task").load();$(this).trigger("reset");$("#add-new-task").modal("hide")}});$(".taskTables").on("click",".edit-task",function(){var a=$(this).attr("task_id");$.ajax({url:base_url+"admin_master/retrieve/task/id/"+a,type:"post",dataType:"json",data:{id:a},success:function(c){var b=c.data[0];$("#task_id").val(b.id);$("#gettask_name").val(b.name);$("#gettask_project").val(b.project_id);$("#gettask_status").val(b.status);$("#gettask_audio_date").val(b.audio)},error:function(b){console.log("unable to send request..")}})});$("#update-task").on("aftersubmit",function(b,a){toastr[a.type](a.message);if(a.type==="success"){$("#edit-task").modal("hide");taskTable.ajax.url(base_url+"admin_master/task").load()}});$(".taskTables").on("click",".delete_task",function(){var a=$(this).attr("task_id");swal({title:"Are you sure?",text:"You won't be able to revert this!",type:"warning",showCancelButton:true,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, Delete !"}).then(function(b){if(b.value){$.ajax({url:base_url+"admin_master/delete_task",type:"post",dataType:"json",data:{id:a},success:function(c){if(c.type==="success"){toastr[c.type](c.message);taskTable.ajax.url(base_url+"admin_master/task").load()}else{if(c.type==="error"){toastr[c.type](c.message)}}},error:function(c){console.log("unable to send request..")}})}})});$(".subappend-new").on("click",function(){var b='<div class="row mb-3 m-0 p-2 bg-white item-roww"><div class="col-lg-12 p-2 sub-task"><h5>Feedback</h5></div><div class="col-lg-6 p-2"><div class="form-group"><label for="feed_sent">Sub Task Sent Date</label><input type="date" class="form-control" id="feed_sent" name="feed_sent[]" required="true"></div></div><div class="col-lg-6 p-2"><div class="form-group"><label for="feed_status">Sub Task Status</label><select class="form-control" name="feed_status[]" id="feed_status"><option value="">--Select Sub Task Status--</option><option value="Approve">Approve</option><option value="Pending">Pending</option><option value=">Resend">Resend</option><option value="Other">Other</option></select></div></div><div class="col-lg-6 p-2"><div class="form-group"><label for="feed_feedback_date">Sub Task Feedback Date</label><input type="date" class="form-control" id="feed_feedback_date" name="feed_feedback_date[]"></div></div><div class="col-lg-6 p-2"><div class="form-group"><label for="feed_file_name">Feedback File Name</label><input type="text" class="form-control" id="feed_file_name" name="feed_file_name[]"></div></div><div class="col-lg-12 p-2"><div class="form-group"><label for="feed_remark">Feedback Remark</label><textarea type="text" class="form-control" rows="5" id="feed_remark" name="feed_remark[]"></textarea></div></div><div class="col-lg-12 p-2"><div class="form-group"><label for="feed_file">Feedback File Upload</label><input type="file" id="feed_file" name="feed_file[]" class="form-control-file by-primary border"></div></div></div></div>';var a=$(this).index('[name="'+$(this).attr("name")+'"]');$(".tem-ss").append(b);$($('[name="'+$(this).attr("name")+'"]')[a+1]).click();return false});var feedTable=$(".feedTables").DataTable({serverSide:false,ajax:base_url+"admin_master/feed",columns:[{data:"sr_no"},{data:"name"},{data:"task_id"},{data:"project_id"},{data:"start_date"},{data:"due_date"},{data:"complete_date"},{data:"approve_date"},{data:"action"}]});$("#update-feed").on("aftersubmit",function(b,a){toastr[a.type](a.message);if(a.type==="success"){taskTable.ajax.url(base_url+"admin_master/feed").load();location.reload(true)}});$(".feedTables").on("click",".delete_feed",function(){var a=$(this).attr("id");swal({title:"Are you sure?",text:"You won't be able to revert this!",type:"warning",showCancelButton:true,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, Delete !"}).then(function(b){if(b.value){$.ajax({url:base_url+"admin_master/delete_feed",type:"post",dataType:"json",data:{id:a},success:function(c){if(c.type==="success"){toastr[c.type](c.message);feedTable.ajax.url(base_url+"admin_master/feed").load()}else{if(c.type==="error"){toastr[c.type](c.message)}}},error:function(c){console.log("unable to send request..")}})}})});